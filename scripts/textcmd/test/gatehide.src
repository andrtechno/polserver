use uo;
use os;

const ITEM_OBJECT := 0x16008;

program gatehide(who)
    var rune := Target(who);
    var dest := GetObjProperty(rune, "Destination");

    if(dest!=error)
        var tox := CInt(dest.x);
        var toy := CInt(dest.y);
        var toz := CInt(dest.z);


        var gump1 := SendTextEntryGump(who, "Portal name 1:");
        var gate1 := CreateItemAtLocation(who.x, who.y, who.z, ITEM_OBJECT, 1, dest.realm);
        gate1.movable := 0;
        gate1.invisible := 1;
        gate1.name := "Portal to 1";
        if(gump1)
            gate1.name := "Portal to "+gump1;
        endif;

        var gump2 := SendTextEntryGump(who, "Portal name 2:");
        var gate2 := CreateItemAtLocation(tox, toy, toz, ITEM_OBJECT, 1, dest.realm);
        gate2.movable := 0;
        gate2.invisible := 1;
        gate2.name := "Portal to 2";
        if(gump2)
            gate2.name := "Portal to "+gump2;
        endif;

        if(gate1 && gate2)
            SetObjProperty(gate1, "GateDestX", gate2.x);
            SetObjProperty(gate1, "GateDestY", gate2.y);
            SetObjProperty(gate1, "GateDestZ", gate2.z);
            SetObjProperty(gate1, "DestRealm", "britannia");

            SetObjProperty(gate2, "GateDestX", gate1.x);
            SetObjProperty(gate2, "GateDestY", gate1.y);
            SetObjProperty(gate2, "GateDestZ", gate1.z);
            SetObjProperty(gate2, "DestRealm", "britannia");
        endif
    endif
endprogram
