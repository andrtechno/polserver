use uo;
use os;

const ITEM_OBJECT := 0x16008;

program gatehide(who)
    var rune := Target(who);
    var dest := GetObjProperty(rune, "Destination");

    if(dest!=error)
        var tox := CInt(dest.x);
        var toy := CInt(dest.y);
        var toz := CInt(dest.z);
        var realm := dest.realm;


        var gump1 := SendTextEntryGump(who, "Portal name 1:");
        var gate1 := CreateItemAtLocation(who.x, who.y, who.z, ITEM_OBJECT, 1, who.realm);
        gate1.movable := 0;

        gate1.name := "Portal to 1";
        if(gump1)
            gate1.name := "Portal to "+gump1;
        endif;

        var gump2 := SendTextEntryGump(who, "Portal name 2:");
        var gate2 := CreateItemAtLocation(tox, toy, toz, ITEM_OBJECT, 1, realm);
        gate2.movable := 0;

        gate2.name := "Portal to 2";
        if(gump2)
            gate2.name := "Portal to "+gump2;
        endif;

        if(gate1 && gate2)
            gate1.SetDestination(gate2.x, gate2.y, gate2.z, realm);
            gate2.SetDestination(gate1.x, gate1.y, gate1.z, who.realm);

        endif
    endif
endprogram
