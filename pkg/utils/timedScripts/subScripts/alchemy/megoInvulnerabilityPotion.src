use uo;
use os;
include ":timedScripts:timedScripts";

include ":attributes:attributes";

program TimedScript_MegoInvulnerability(params)
	var mobile := params[1];
	var points := params[3];
    var duration := params[4];
	params := 0;
	
	// Prevents mod from being applied twice.
	if ( GetObjProperty(mobile, "MegoInvulnerabilityPotion") )
		return 0;
	endif

	var pointsData := struct;
	pointsData.+ar_mod := points;

	var cfg_elem := TS_GetCfgElem("MegoInvulnerabilityPotion");
    var buff_icon := CInt( cfg_elem.BuffIcon );
    var cliloc_name :=  CInt(cfg_elem.cliloc_name);
    var cliloc_desc :=  CInt(cfg_elem.cliloc_desc);

	mobile.addBuff(buff_icon, duration, cliloc_name, cliloc_desc, {});

	SetObjProperty(mobile, "MegoInvulnerabilityPotion", pointsData);
	//AP_ModifyStatMod(mobile, DEXTERITY, pointsData.dex);
	//AP_ModifyStatMod(mobile, INTELLIGENCE, pointsData.int);
	//AP_ModifyStatMod(mobile, STRENGTH, pointsData.str);
	
	return 1;
endprogram

